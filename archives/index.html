<!DOCTYPE html><html class="appearance-user-can-set" lang="en"><head><meta charset="UTF-8"><title>lhl_2507's blog</title><meta name="description" content="月明星稀 乌鹊南飞"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q || []).push(arguments)},i[r].l=1 * new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'lhl_2507', 'auto');
ga('send', 'pageview');</script><!-- End Google Analytics -->
<!-- Baidu Analytics --><script>var _hmt = _hmt || [];
(function() {
var hm = document.createElement("script");
hm.src = "//hm.baidu.com/hm.js?" + 'lhl_2507';
var s = document.getElementsByTagName("script")[0];
s.parentNode.insertBefore(hm, s);
})();</script><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/widget-post-list.css"><meta name="generator" content="Hexo 6.0.0"></head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">lhl_2507's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><span>Archives · All</span></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></header><main><article class="post-container is-flex is-justify-content-center section container is-max-widescreen pt-4 px-2"><div class="columns is-variable is-1-tablet is-3-desktop-only is-2-widescreen is-full-width"><section class="column"><article class="post-item-card"><header class="is-relative is-flex"><div class="post-cover-backdrop is-hidden"><img src="https://cdn.jsdelivr.net/gh/lhl7/My_pics/Typora/image-20220118144411257.png" alt="loading.."></div><a class="post-cover-link has-text-centered skeleton" href="/2022/01/18/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8CReverse%E8%BF%9B%E9%98%B6%E5%8C%BA-BABYRE-writeup/"><img class="post-cover-img js-img-fadeIn" src="https://cdn.jsdelivr.net/gh/lhl7/My_pics/Typora/image-20220118144411257.png" alt="loading.." data-backdrop="true"></a></header><section class="content post-card-content p-4 pb-5"><h2 class="mt-4 mb-0 is-family-serif"><a href="/2022/01/18/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8CReverse%E8%BF%9B%E9%98%B6%E5%8C%BA-BABYRE-writeup/">攻防世界Reverse进阶区-BABYRE-writeup</a></h2><time class="has-text-grey" datetime="2022-01-18T07:19:40.677Z">2022-01-18</time><p class="is-flex-grow-2 mt-2">攻防世界Reverse进阶区-BABYRE-writeup以此篇WP记录第一次使用ida解决smc（自解密）
观察反汇编代码：

第12行调用的函数在第8行被加密了
因此，需要手动解密观察，双击judge进入：

然后使用idapython脚本解决，右上角file、script command
如图编写代码：

点击run，可以看到内容被改变：
选中judge函数一行，c（code），将其变成代码，这时的judge被分为三个函数，我们将其合三为1，框选地址B00~BB5（所有红色区域），p（重新生成function）
此时可以在左侧找到相应函数内容，F5即可

然后针对反汇编后的加密算法写一个脚本：
12345678v2=[&amp;#x27;f&amp;#x27;,&amp;#x27;m&amp;#x27;,&amp;#x27;c&amp;#x27;,..</p><a class="button is-default mt-2 has-text-weight-semibold" href="/2022/01/18/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8CReverse%E8%BF%9B%E9%98%B6%E5%8C%BA-BABYRE-writeup/">Read more</a></section></article><article class="post-item-card"><header class="is-relative is-flex"><div class="post-cover-backdrop is-hidden"><img src="https://cdn.jsdelivr.net/gh/lhl7/My_pics/Typora/image-20220117123155980.png" alt="loading.."></div><a class="post-cover-link has-text-centered skeleton" href="/2022/01/17/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8CReverse%E8%BF%9B%E9%98%B6%E5%8C%BA-%E6%B5%81%E6%B5%AA%E8%80%85-writeup/"><img class="post-cover-img js-img-fadeIn" src="https://cdn.jsdelivr.net/gh/lhl7/My_pics/Typora/image-20220117123155980.png" alt="loading.." data-backdrop="true"></a></header><section class="content post-card-content p-4 pb-5"><h2 class="mt-4 mb-0 is-family-serif"><a href="/2022/01/17/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8CReverse%E8%BF%9B%E9%98%B6%E5%8C%BA-%E6%B5%81%E6%B5%AA%E8%80%85-writeup/">攻防世界Reverse进阶区-流浪者-writeup</a></h2><time class="has-text-grey" datetime="2022-01-17T04:36:09.653Z">2022-01-17</time><p class="is-flex-grow-2 mt-2">攻防世界Reverse进阶区-流浪者-writeup
关键函数1：sub_401890
调用了另一个函数

关键函数2：sub_4017F0
先传入关键函数1进行加密，加密后进入函数2进行进一步加密，最后与kanXue...字符串对比查验
逆向脚本书写逻辑即可

最终运行结果：

</p><a class="button is-default mt-2 has-text-weight-semibold" href="/2022/01/17/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8CReverse%E8%BF%9B%E9%98%B6%E5%8C%BA-%E6%B5%81%E6%B5%AA%E8%80%85-writeup/">Read more</a></section></article><article class="post-item-card"><section class="content post-card-content p-4 pb-5"><h2 class="mt-4 mb-0 is-family-serif"><a href="/2022/01/16/python%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E4%BB%A5%E5%8F%8A%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0/">python笔记</a></h2><time class="has-text-grey" datetime="2022-01-16T14:31:38.600Z">2022-01-16</time><p class="is-flex-grow-2 mt-2">python笔记Python3 中有六个标准的数据类型：

Number（数字）
String（字符串）
List（列表）
Tuple（元组）
Set（集合）
Dictionary（字典）

Python3 的六个标准数据类型中：

不可变数据（3 个）：Number（数字）、String（字符串）、Tuple（元组）；

可变数据（3 个）：List（列表）、Dictionary（字典）、Set（集合）。

Python数据类型转换有时候，我们需要对数据内置的类型进行转换，数据类型的转换，你只需要将数据类型作为函数名即可，在下一章节 Python3 数据类型转换 会具体介绍。
以下几个内置的函数可以执行数据类型之间的转换。这些函数返回一个新的对象，表示转换的值。



函数
描述



[int(x ,b..</p><a class="button is-default mt-2 has-text-weight-semibold" href="/2022/01/16/python%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E4%BB%A5%E5%8F%8A%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0/">Read more</a></section></article><article class="post-item-card"><header class="is-relative is-flex"><div class="post-cover-backdrop is-hidden"><img src="https://cdn.jsdelivr.net/gh/lhl7/My_pics/Typora/v2-976d8be2a77238a37736be97bac66497_r.jpg" alt="loading.."></div><a class="post-cover-link has-text-centered skeleton" href="/2022/01/14/%E5%85%B3%E4%BA%8E%E7%BC%96%E7%A0%81/"><img class="post-cover-img js-img-fadeIn" src="https://cdn.jsdelivr.net/gh/lhl7/My_pics/Typora/v2-976d8be2a77238a37736be97bac66497_r.jpg" alt="loading.." data-backdrop="true"></a></header><section class="content post-card-content p-4 pb-5"><h2 class="mt-4 mb-0 is-family-serif"><a href="/2022/01/14/%E5%85%B3%E4%BA%8E%E7%BC%96%E7%A0%81/">关于编码方式的总结</a></h2><time class="has-text-grey" datetime="2022-01-14T03:05:51.384Z">2022-01-14</time><p class="is-flex-grow-2 mt-2">各类编码总结一、ascii、UTF-8、gbk1、ascii码ASCII 码一共规定了128个字符的编码：

2、UTF-8、UTF-16、UTF-32utf（Unicode Transformation Format）
UTF-8:​    utf-8是unicode的实现方法。其编码规则如下：

1）对于单字节的符号：字节的第一位设为0，后面7位为这个符号的 Unicode 码。因此对于英语字母，UTF-8 编码和 ASCII 码是相同的；
2）对于n字节的符号（n &amp;gt; 1）：第一个字节的前n位都设为1，第n + 1位设为0，后面字节的前两位一律设为10。剩下的没有提及的二进制位，全部为这个符号的 Unicode 码。


举例说明：
选择汉字“鲁”，在unicode官网查询其编码为U+9C81
..</p><a class="button is-default mt-2 has-text-weight-semibold" href="/2022/01/14/%E5%85%B3%E4%BA%8E%E7%BC%96%E7%A0%81/">Read more</a></section></article><article class="post-item-card"><header class="is-relative is-flex"><div class="post-cover-backdrop is-hidden"><img src="https://cdn.jsdelivr.net/gh/lhl7/My_pics/Typora/image-20220111170123070.png" alt="loading.."></div><a class="post-cover-link has-text-centered skeleton" href="/2022/01/11/PIKACHU%E9%80%9A%E5%85%B3_DAY2_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"><img class="post-cover-img js-img-fadeIn" src="https://cdn.jsdelivr.net/gh/lhl7/My_pics/Typora/image-20220111170123070.png" alt="loading.." data-backdrop="true"></a></header><section class="content post-card-content p-4 pb-5"><h2 class="mt-4 mb-0 is-family-serif"><a href="/2022/01/11/PIKACHU%E9%80%9A%E5%85%B3_DAY2_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">pikachu_命令执行</a></h2><time class="has-text-grey" datetime="2022-01-11T13:18:41.411Z">2022-01-11</time><p class="is-flex-grow-2 mt-2">PIKACHU通关_命令执行一般出现这种漏洞，是因为应用系统从设计上需要给用户提供指定的远程命令操作的接口。比如我们常见的路由器、防火墙、入侵检测等设备的web管理界面上一般会给用户提供一个ping操作的web界面，用户从web界面输入目标IP，提交后，后台会对该IP地址进行一次ping测试，并返回测试结果。 但是如果设计者在完成该功能时，没有做严格的安全控制，则可能会导致攻击者通过该接口提交“意想不到”的命令，从而让后台进行执行，从而控制整个后台服务器。
命令连接符windows系统和linux系统各有4个，其中3个是共有的，各有1个是特有的：

windows系统：| 、||、&amp;amp;&amp;amp;、&amp;amp;
linux系统：| 、||、&amp;amp;&amp;amp;、;

总结一下各连接符号的作用：

 |  ..</p><a class="button is-default mt-2 has-text-weight-semibold" href="/2022/01/11/PIKACHU%E9%80%9A%E5%85%B3_DAY2_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">Read more</a></section></article><article class="post-item-card"><header class="is-relative is-flex"><div class="post-cover-backdrop is-hidden"><img src="https://cdn.jsdelivr.net/gh/lhl7/My_pics/Typora/image-20220111100429372.png" alt="loading.."></div><a class="post-cover-link has-text-centered skeleton" href="/2022/01/11/PIKACHU%E9%80%9A%E5%85%B3_DAY1_%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/"><img class="post-cover-img js-img-fadeIn" src="https://cdn.jsdelivr.net/gh/lhl7/My_pics/Typora/image-20220111100429372.png" alt="loading.." data-backdrop="true"></a></header><section class="content post-card-content p-4 pb-5"><h2 class="mt-4 mb-0 is-family-serif"><a href="/2022/01/11/PIKACHU%E9%80%9A%E5%85%B3_DAY1_%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/">pikachu_暴力破解</a></h2><time class="has-text-grey" datetime="2022-01-11T07:12:21.694Z">2022-01-11</time><p class="is-flex-grow-2 mt-2">PIKACHU通关_暴力破解暴力破解需要将表单传到 Intruder(入侵者)模块

在这里记录一下四种四种AttackType:

Sinper（狙击手）:
输入一个字典，分别对每一个被标记的位置用此字典遍历。

Battering ram（攻城槌）：
输入一个字典，同时对每一个被标记的位置用此字典遍历。

Pitchfork（干草叉）
输入多个字典，按照顺序，从上到下对应遍历。（以最短的字典长度为遍历次数）

Cluster bomb（集束炸弹）
输入多个字典，遍历所有可能性，排列组合。


第一关——普通爆破回到暴力破解，我们使用Cluster bomb进行字典爆破：


分别对用户名和密码的爆破上传字典，若用户名和密码有特殊字符需求，不勾选URL-encoding:

点击开始爆破，观察返回报文的长..</p><a class="button is-default mt-2 has-text-weight-semibold" href="/2022/01/11/PIKACHU%E9%80%9A%E5%85%B3_DAY1_%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/">Read more</a></section></article><article class="post-item-card"><section class="content post-card-content p-4 pb-5"><h2 class="mt-4 mb-0 is-family-serif"><a href="/2022/01/08/Nmap%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0/">Nmap使用笔记</a></h2><time class="has-text-grey" datetime="2022-01-08T03:32:09.633Z">2022-01-08</time><p class="is-flex-grow-2 mt-2">NMAP使用笔记NMAP的作用是在信息收集阶段进行端口扫描。
一、端口扫描：要给sudo权限
namp xx.com -p 80 -sS（syn扫描方式）
此外还有-sS/sT/sA/sW/sM 分别对应SYN/Connect()/ACK/window/Maimon
-sU对应UDP
-sN/sF/sX对应TCP null/FIN/Xmas
加 -sV -O可以扫描主机版本 ，操作系统等等信息
namp xx.com -p 80 -A效果相同（推荐） 
扫描所有端口：namp xx.com -A -sS(不讲武德，推荐) 
使用 -iR随机扫描域名
扫描五个最常见的端口 nmap xx.com --top-ports 5
输出到文件-oN [文件路径+文件名]
脚本扫描--script=[文件路径./.....</p><a class="button is-default mt-2 has-text-weight-semibold" href="/2022/01/08/Nmap%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0/">Read more</a></section></article><article class="post-item-card"><section class="content post-card-content p-4 pb-5"><h2 class="mt-4 mb-0 is-family-serif"><a href="/2022/01/06/kali%E8%A3%85%E6%9C%BA%E8%BF%87%E7%A8%8B/">Kali安装</a></h2><time class="has-text-grey" datetime="2022-01-06T14:16:01.577Z">2022-01-06</time><p class="is-flex-grow-2 mt-2">kali装机过程磁盘管理
设别管理器
系统信息
下载系统iso文件 rufus 3.14 将内容刻录到u盘
关机开机后，按住F1
进入bios窗口，选Security  进入Security Boot 将Secure Boot改为Disabled
F10退出 按住F12 进入Boot Menu 选使用用来装机的USB设备，回车
进入kali界面，卡了一下，等待
图形化安装，选择语言和国家
安装完毕后，连接WIFI
磁盘分区，选择整个磁盘（前提是备份电脑中的所有内容），选择电脑（最大的）的磁盘
放在同一分区下，确定后选择“是”要更改
最后一步，直接重启，先不拔出USB
拔出USB后，需要对u盘重新分区，使用windows的diskpart命令和磁盘管理。
</p><a class="button is-default mt-2 has-text-weight-semibold" href="/2022/01/06/kali%E8%A3%85%E6%9C%BA%E8%BF%87%E7%A8%8B/">Read more</a></section></article><article class="post-item-card"><section class="content post-card-content p-4 pb-5"><h2 class="mt-4 mb-0 is-family-serif"><a href="/2022/01/04/hello-world/">Hello World</a></h2><time class="has-text-grey" datetime="2022-01-04T06:57:26.942Z">2022-01-04</time><p class="is-flex-grow-2 mt-2">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.
Quick StartCreate a new post1$ hexo new &amp;quot;My New Post&amp;quot;

More info: Writing
Run server1$ hexo server

More info: Server
Generate static files1$ hexo genera..</p><a class="button is-default mt-2 has-text-weight-semibold" href="/2022/01/04/hello-world/">Read more</a></section></article></section><aside class="column is-hidden-mobile is-4-tablet is-3-widescreen"><div style="position: sticky; top: 50px;"><main class="aside-card-container archives-widget is-in-archive-page"><h3>Archives</h3><section><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a><span class="archive-list-count">9</span></li></ul></section></main></div></aside></div></article><script>$claudia.fadeInImage(null, $claudia.blurBackdropImg)

window.addEventListener('resize', $claudia.throttle(function () {
    var images = document.querySelectorAll('.js-img-fadeIn')

    images.forEach($claudia.blurBackdropImg)
}, 150))</script></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><a title="twitter" target="_blank" rel="noopener nofollow" href="//twitter.com/jacky_478"><i class="iconfont icon-twitter"></i></a><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/lhl7"><i class="iconfont icon-github"></i></a><!-- Ins--><a title="instagram" target="_blank" rel="noopener nofollow" href="//www.instagram.com/lhl_2507"><i class="iconfont icon-ins"></i></a><!-- RSS--><!-- 知乎--><a title="zhihu" target="_blank" rel="noopener nofollow" href="//zhihu.com/people/loki-45-54"><i class="iconfont icon-zhihu"></i></a><!-- 领英--><!-- 脸书--><a title="facebook" target="_blank" rel="noopener nofollow" href="//www.facebook.com//"><i class="iconfont icon-tian7_facebook"></i></a></section><p><span>Copyright ©</span><span> lhl_2507 2022</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script>$claudia.fadeInImage(null, $claudia.blurBackdropImg)

window.addEventListener('resize', $claudia.throttle(function () {
    var images = document.querySelectorAll('.js-img-fadeIn')

    images.forEach($claudia.blurBackdropImg)
}, 150))</script></body></html>